<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>2013 Western States Endurance Run Lottery</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>2013 Western States Endurance Run Lottery</h1>

<p>Last update by Benjamin Chan (<a href="mailto:benjamin.ks.chan@gmail.com">benjamin.ks.chan@gmail.com</a>) on <code>2012-12-04 15:18:08</code> using <code>R version 2.15.2 (2012-10-26)</code>.</p>

<p>I was a little intrigued by how the Western States Endurance Run (WSER) calculated their lottery odds estimates. Their estimates can be found on the <a href="http://www.wser.org/2012/12/03/dec-8-lottery-details">WSER website</a>.</p>

<blockquote>
<p>As posted on the lottery applicant page, we have 2302 total lottery applicants for the 2013 race.</p>

<p>122 applicants with four tickets = 488 tickets</p>

<p>207 applicants with three tickets = 621 tickets</p>

<p>482 applicants with two tickets = 964 tickets</p>

<p>1491 applicants with one ticket = 1491 tickets</p>

<p>Total tickets in the hat = 3564</p>

<p>We are going to draw 270 unique names in the lottery and then an additional five from the lottery within the lottery. That is, the folks in the audience who have not been selected up to that point. Based on 3564 total tickets and 270 names drawn, the odds of getting selected have been calculated as follows:</p>

<p>one ticket odds = 7.6%</p>

<p>two ticket odds = 14.6%</p>

<p>three ticket odds = 21.1%</p>

<p>four ticket odds = 27.1%</p>

<p>\( E(X) = \sum X P(X) \). What this is saying (in English) is &ldquo;The expected value is the sum of all the gains multiplied by their individual probabilities.&rdquo;</p>
</blockquote>

<p>First, what are labeled as <em>odds</em> appear to really be <em>probabilities</em>. Second, it is unclear how the equation for expected value was used to calculate these  probabilities.</p>

<p>At first, I suspected the reason might be the automatic spots. But the text of the lottery process above is clear that the 270 runners that will be drawn will be solely from the lottery applicants and will not include the automatic spots.</p>

<p>Here, I run a simulation of the lottery process to estimate probabilities of winning a slot for the Western States Endurance Run. The simulation does a few things</p>

<ul>
<li>Accounts for the changing probability distribution of the lottery hat as runners are selected</li>
<li>Once a runner is selected, their tickets are withdrawn from the hat</li>
<li>For each simulated lottery, the distribution of selected 1-ticket, 2-ticket, 3-ticket, and 4-ticket runners is determined</li>
<li>From this distributions of the simulated lotteries, the estimated selection probabilities are characterized</li>
<li>Selection probability distributions are plotted</li>
<li>Selection distributions from the simulated lotteries are also plotted</li>
</ul>

<p>Load the required packages.</p>

<pre><code class="r">require(xtable, quietly = TRUE)
require(ggplot2, quietly = TRUE)
</code></pre>

<h2>Setting up the initial condition</h2>

<p>Here is the code to set up the lottery hat data frame at the initial state. Print out some validation output just to make sure the initial state is set up correctly.</p>

<pre><code class="r">applicants &lt;- 2302
spots &lt;- 270
runner &lt;- seq(1, applicants)
n &lt;- c(1491, 482, 207, 122)
tickets &lt;- c(rep(4, n[4]), rep(3, n[3]), rep(2, n[2]), rep(1, n[1]))
dfHat0 &lt;- data.frame(runner, tickets)
dfHat0$prob &lt;- dfHat0$tickets/sum(dfHat0$tickets)
table(factor(dfHat0$tickets))
</code></pre>

<pre><code>## 
##    1    2    3    4 
## 1491  482  207  122
</code></pre>

<pre><code class="r">head(dfHat0)
</code></pre>

<pre><code>##   runner tickets     prob
## 1      1       4 0.001122
## 2      2       4 0.001122
## 3      3       4 0.001122
## 4      4       4 0.001122
## 5      5       4 0.001122
## 6      6       4 0.001122
</code></pre>

<pre><code class="r">tail(dfHat0)
</code></pre>

<pre><code>##      runner tickets      prob
## 2297   2297       1 0.0002806
## 2298   2298       1 0.0002806
## 2299   2299       1 0.0002806
## 2300   2300       1 0.0002806
## 2301   2301       1 0.0002806
## 2302   2302       1 0.0002806
</code></pre>

<h2>Simulation</h2>

<p>The simulation needs to account for the changing relative distribution of tickets after a person is selected and their tickets are no longer in the pool of eligible tickets.</p>

<p>The matrix <code>lottery</code> is an \( I \times J \) matrix where row \( i \) is the \( i \)-th simulation and the column \( j \) is the \( j \)-th lottery winner drawn. The number of columns in the matrix is <code>270</code>, variable <code>spots</code>. The number of simulated lotteries is variable <code>size</code>. Set the random number seed as the date of the lottery in numeric form multipied by the number of applicants.</p>

<pre><code class="r">size &lt;- 1000
set.seed(as.numeric(as.Date(&quot;2012-12-08&quot;, format = &quot;%Y-%m-%d&quot;)) * applicants)
lottery &lt;- matrix(nrow = size, ncol = spots)
start &lt;- Sys.time()
for (i in 1:size) {
    dfHat &lt;- dfHat0
    for (j in 1:spots) {
        lottery[i, j] &lt;- sample(dfHat$runner, 1, prob = dfHat$prob)
        dfHat &lt;- subset(dfHat, runner != lottery[i, j])
        dfHat$prob &lt;- dfHat$tickets/sum(dfHat$tickets)
    }
}
end &lt;- Sys.time()
end - start
</code></pre>

<pre><code>## Time difference of 2.868 mins
</code></pre>

<p>Here&#39;s an example of the selected runners drawn from a random simulated lottery.</p>

<pre><code class="r">i &lt;- sample(seq(1, size), 1)
sampLottery &lt;- list(i, sort(lottery[i, ]))
names(sampLottery) &lt;- c(&quot;lottery&quot;, &quot;runner&quot;)
sampLottery
</code></pre>

<pre><code>## $lottery
## [1] 782
## 
## $runner
##   [1]    2    5    7   11   14   18   25   30   31   32   33   39   40   42
##  [15]   48   49   53   63   78   80   84   86   89   97  100  101  107  109
##  [29]  114  115  116  117  120  123  127  133  135  144  147  152  153  157
##  [43]  164  167  168  173  178  186  192  193  196  202  212  217  219  220
##  [57]  223  226  230  231  247  248  249  257  262  265  266  269  272  277
##  [71]  280  289  290  291  293  294  297  303  308  319  325  336  340  343
##  [85]  356  358  372  380  381  387  389  406  417  422  424  433  434  469
##  [99]  471  480  492  493  510  517  518  523  533  542  548  552  553  554
## [113]  580  588  599  610  616  623  661  668  685  688  690  696  705  709
## [127]  711  720  728  731  739  747  755  757  763  765  766  796  801  804
## [141]  832  846  850  862  870  874  878  885  899  901  907  968  973  979
## [155]  983  992  997 1000 1021 1037 1059 1061 1074 1090 1106 1111 1112 1122
## [169] 1149 1154 1159 1164 1170 1204 1230 1251 1252 1262 1270 1274 1311 1313
## [183] 1317 1323 1330 1337 1349 1400 1405 1419 1440 1447 1455 1457 1459 1478
## [197] 1480 1484 1493 1499 1515 1525 1532 1546 1553 1554 1577 1580 1584 1592
## [211] 1593 1600 1603 1630 1681 1693 1695 1696 1699 1718 1730 1751 1770 1794
## [225] 1807 1849 1855 1861 1862 1863 1868 1883 1887 1892 1896 1915 1929 1936
## [239] 1940 1945 1969 1974 1977 1978 1981 1985 1995 1999 2005 2058 2072 2083
## [253] 2115 2125 2134 2137 2140 2156 2162 2175 2196 2198 2203 2213 2224 2263
## [267] 2270 2272 2275 2286
</code></pre>

<h2>Summary</h2>

<p>I&#39;m not really interested in which runners were selected in the lottery simulation. What I&#39;m really after are estimates for the probability of selecting a runner, among the <code>270</code> available spots, with \( X \) tickets in the initial hat.</p>

<p>To get at this, first I&#39;ll have to match the runners selected to the number of tickets they started out with.</p>

<pre><code class="r">lottery2 &lt;- matrix(nrow = size, ncol = spots)
for (i in 1:size) {
    lottery2[i, ] &lt;- dfHat0$tickets[lottery[i, ]]
}
</code></pre>

<p>Reformat the <code>lottery2</code> matrix to an aggregated data frame for analysis.</p>

<pre><code class="r">tickets &lt;- factor(as.vector(t(lottery2)))
sim &lt;- rep(seq(1, size), each = spots)
dfLottery &lt;- data.frame(sim, tickets)
aggLottery &lt;- aggregate(tickets ~ sim, dfLottery, table)
sim &lt;- rep(seq(1, size), each = 4)
tickets &lt;- factor(rep(seq(1, 4), size))
freq &lt;- as.vector(t(aggLottery$tickets))
dfSummary &lt;- data.frame(sim, tickets, freq)
</code></pre>

<p>For each type of lottery applicant (1 ticket, 2 tickets, etc.), calculate the proportion of selected applicants. Print a summary table of the mean and median selection probabilities and their standard deviations.</p>

<pre><code class="r">total &lt;- rep(n, size)
dfSummary$prob &lt;- 100 * (dfSummary$freq/total)
avg &lt;- aggregate(prob ~ tickets, dfSummary, mean)
med &lt;- aggregate(prob ~ tickets, dfSummary, median)
sd &lt;- aggregate(prob ~ tickets, dfSummary, sd)
comparison &lt;- c(7.6, 14.6, 21.1, 27.1)
simsum &lt;- data.frame(comparison, avg, med[, 2], sd[, 2], n, n * avg[, 2]/100)
names(simsum) &lt;- c(&quot;Comparison&quot;, &quot;Tickets&quot;, &quot;Mean&quot;, &quot;Median&quot;, &quot;SD&quot;, &quot;N&quot;, &quot;Expected&quot;)
print(xtable(simsum), type = &quot;html&quot;, include.rownames = FALSE)
</code></pre>

<!-- html table generated in R 2.15.2 by xtable 1.7-0 package -->

<!-- Tue Dec 04 15:21:03 2012 -->

<TABLE border=1>
<TR> <TH> Comparison </TH> <TH> Tickets </TH> <TH> Mean </TH> <TH> Median </TH> <TH> SD </TH> <TH> N </TH> <TH> Expected </TH>  </TR>
  <TR> <TD align="right"> 7.60 </TD> <TD> 1 </TD> <TD align="right"> 7.90 </TD> <TD align="right"> 7.91 </TD> <TD align="right"> 0.50 </TD> <TD align="right"> 1491.00 </TD> <TD align="right"> 117.74 </TD> </TR>
  <TR> <TD align="right"> 14.60 </TD> <TD> 2 </TD> <TD align="right"> 15.14 </TD> <TD align="right"> 15.15 </TD> <TD align="right"> 1.40 </TD> <TD align="right"> 482.00 </TD> <TD align="right"> 72.99 </TD> </TR>
  <TR> <TD align="right"> 21.10 </TD> <TD> 3 </TD> <TD align="right"> 21.77 </TD> <TD align="right"> 21.74 </TD> <TD align="right"> 2.53 </TD> <TD align="right"> 207.00 </TD> <TD align="right"> 45.05 </TD> </TR>
  <TR> <TD align="right"> 27.10 </TD> <TD> 4 </TD> <TD align="right"> 28.05 </TD> <TD align="right"> 27.87 </TD> <TD align="right"> 3.96 </TD> <TD align="right"> 122.00 </TD> <TD align="right"> 34.22 </TD> </TR>
   </TABLE>

<p>Plot the distribution of probabilities from the <code>1000</code> simulated lotteries. Annotate with the estimated mean selection probability.</p>

<pre><code class="r">y1 &lt;- max(density(dfSummary$prob[dfSummary$tickets == 1])$y)
y2 &lt;- max(density(dfSummary$prob[dfSummary$tickets == 2])$y)
y3 &lt;- max(density(dfSummary$prob[dfSummary$tickets == 3])$y)
y4 &lt;- max(density(dfSummary$prob[dfSummary$tickets == 4])$y)
y &lt;- c(y1, y2, y3, y4)
ggplot(dfSummary, aes(x = prob, y = ..density.., fill = tickets)) + geom_density(alpha = 1/2, 
    color = NA) + scale_fill_brewer(type = &quot;div&quot;, palette = &quot;BrBG&quot;) + labs(title = &quot;2012 WSER Lottery Selection Probability Densities&quot;, 
    x = &quot;Percent&quot;, y = paste(&quot;Proportion of&quot;, size, &quot;simulations&quot;), fill = &quot;Tickets&quot;) + 
    annotate(&quot;text&quot;, label = format(simsum$Mean, digits = 2, trim = TRUE), x = simsum$Mean, 
        y = y) + theme(legend.position = &quot;bottom&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAACB1BMVEUAAAAAACYAADMAADoAAEcAAFwAAGYAKGAAMGQAMWcAM1wAM4AANogAOmYAOpAASHoAS38AXKMAYawAZpAAZrYZAAAZACYZZpMbaZgsXG0uAAAugasxAAAzAAAzADMzAFwzMwAzM4AzgMU6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6kNtBKABBnKtEKgBHm9NSSABZqpVZr6JbAABbAChblrFcAABcADNcMwBco8Vco+VcrZhdsqVgtahhrPJjZiZjtatkMQBmAABmADpmAGZmOgBmZmZmkJBmtv9zgUVznGBztXpztZNztat5u395u5h5u7F/f39/f5V/f6t/lcF/q9aAMACAMwCAMzOAtbGAwriAxeWINgCNQgCQOgCQOjqQOmaQZgCQkGaQkLaQtpCQ27aQ29uQ2/+Vf6uVlcGVweuh07GjXACj5eWrf6urlcGrq6ur1v+sYQCx0Lmy2bWy2dO007y2ZgC2Zjq22/+2/7a2/9u2//+539m/5uDBlX/BlavBwdbB6//C07HFgDPFgIDFo3/F5eXMqYbSsIzWq3/W///bkDrbkJDbtmbb29vb/9vb///i03/i07Hlo1zlxYDl5aPl5cXl5eXonEnou2fo2oLo2p3o2rfrwZXr1qvr///v4L7y8s/y8vL/tmb/1qv/25D/27b/68H//7b//9b//9v//+v////X/sdJAAAACXBIWXMAAAsSAAALEgHS3X78AAAZBElEQVR4nO3diX8b6V0G8IHQ5SikBAzl2oXGSUtM6eLSAKFcTsqqBUMUkgYScDjamjXZXUxwBak3G9LgTRxxGOXiWNdLZLGOPX8k7zv3jGZ+7zuHZt6Z3/N8nEQajfS80lfvzMixZMtGWMZqegBIMwE80wCeaQDPNIBnGsAzDeCZBvBMA3imATzTAJ5pAM80gGcawDMN4JkG8EwDeKbpGvy/eX9K3kS1KXCL1Q8ikXrhD5Ys65VN2z5csawFZ8nhSi+yXGQwJ/4aO5cOj+/YA8uy5twVLLmOvKaIuMS99kLs9uX55LJ4vNsLBnR+NbGCvPr00mD0Ir3k0l7qeXEj7ldiQO49OJba4F+RGERVqRX+YEk8BEOpN+eelo9CL1wu15Ha9uB351yCgfPvXPjouk8U/7HMDe/fXjCiVPjM4cvuccIsCz649Sl451aSzx/dQVSVWuHH0lY8GpNT4gEZC+Gh9UNf6oXL5TqT05v24Y2vX9j0pox7tQS8c2U78gDJaXR8R/79oytySrvnxQ39pXXs09J56GAHt+evIBd4J+3JvHcTc5GlB+e/Nu9PT3cQotO52VV/jaU35p3Nlbi+3Bz45/0Z/w15i4NwDN49kE/wZMfQ2RJ4V4kObUhuIgql/n28UHfYpPC/bHoPg7tc/iMXTM78u/z79GYwORXwznoDybYQzvqhPC/Wc517wXrBFcUK/pZYnlzq+Vd1lrq3eLAkrj1w23z4nnOzsTWG3nNzIP/1zkc39bEx9Ly7Gza7HXKlsXPFYBDuCt4FlTLUDi8fL2dz7kIH8IHJQDxMC/ZwwZkgcrcqV/Z2r3PBMUF8Uy+fRHZEbuweSDjnHS9nBTu8PX8F8ej6J71H1nvM/Vt0OL2Lgk29c7OxNfwnpr9xksuj8JExePdYLAkG4XX4NQF8YmiVpm54xzcFPtzxjufsgZz0OwPvIGnJiu3jvWeAd86FdzYAchvswQ+dlawF99bFdnYY2a3L2/NXEI+uf3IYbkTkY+7dYhzeOyxzbjZYQ+4+vGeYPPz0z8cP7sIxhPDBILwOed96UfjwbkwdUpZOzfCTeSkVbOrDDd98cDQzOX1b7uAvfOuGv1cTT5H4pn7gz4BM+OCov+fc4rdWoo+buD1/Bfnoeid14KODSMIL9gVvS50CH44h3NQHgwg7BuJ5FYH3VvAuKPfQJ1IvvHdE7Ji7u2nvGDdyrw5vfO2MPLB/48yO92j421M7WN+XJzf1wdqHK294W/rg9vwV/O1pcJl6U+/fbHJTP/Z2Iamb+sgYwoO7YBCRDvcZE93U+w9LxQf6tcJ7x292+HLOewxPRZ/Ng884L+I/4zxczjHt1FH9wZK/2cw6uJMHdXJn7D7I4a7Buz1/BedB9k6KiuHc9MFdFnzy8E+uNJmXt+OeT7yOj4zBfzkXbfb38XLrFjm4c1fwLqjUolZ4b5/VS34DJ1juxH2JO5l3zg4s7zWTt4p/VG95L42CYz7/dc+c80ee93fGwW1Fbs9fwX/NJLc4E/dV2TD+ci4TPvZizPnmg9jD35Yz3T0fwLvmwRgi38DxB+F3DNzXg+5VokMbTH/fqGy69i3b1PjH9NzHEA0L+OHMvw/WjjFEwwB+Mh8eHHMeQzw54Z/LvHheOHbxq6K2XC3gmdYCnmkt4JnWAp5pLeCZ1gKeaS3gmdYCnmkt4JnWAp5pLeCZ1gKeaS3gmdbOEP6x+1My55wzT89a1gnNMemlKwIN1c56xt/8+Pvyn2dXTzh/tMakl64INFQ7Y/jHH3sr/PfJa9e1xqSXrgg0VDtb+GdXT7on7suJ//TsOa0x6aUrAg3Vzhben/DejH8V8MbUzhQ+mPBisov9+00L8MbUzhQ+slOXR/W/dhXwxtTOFP6xe0i/5Z198rNvaY1JL10RaKh2pvA33ddvW1vO3A83/Iox6aUrAg3Vzhbelf6zn3S/mzPlbtZDwat2pvBetrayLjHqoeBVC3imtdrw2/1L9+InAN/mWl34/ct74it6AvCtrtWF312zX779SJz46M29/StySV8kc/sQzcOHD7XWQxpMNvy6fXRXwtv7/WDC6834Lcx4A2u14f0Zv3vF/uivH+WEz5I36qHgVasLH+zag2cA4FtdqwvvHsy/fGfv6L1+fz3vph7wxtVqw6dGa0yAN7EW8ExrAc+0FvBMawHPtBbwTGsBz7QW8ExrAc+0FvBMawHPtBbwTGsBz7QW8ExrAc+0FvBMawHPtBbwTGsBz7QW8ExrAc+0FvBMawHPtBbwTGsBz7QW8Exra4LPkDfqoeBVC3imtYBnWgt4prWAZ1oLeKa1gGdaC3imtYBnWgt4prWAZ1pbDv6FRh44Sb9M6waqD2rF0pnP+C3MeBNrAc+0FvBMawHPtBbwTGsBz7QW8ExrAc+0FvBMawHPtBbwTGsBz7QW8Exr64JPlzfqoeBVC3imtYBnWgt4prWAZ1oLeKa1gGdaC3imtYBnWgt4prWAZ1oLeKa1gGdaC3imtTOH3wK8kbWAZ1oLeKa1gGdaC3imtYBnWgt4prWAZ1oLeKa1gGdaC3imtYBnWgt4prU0/PD4ztCyevLkdv/SPWfZbr9/BfCtryXhD86viq/J6U3b3r+8J77Esn2hvr0O+LbX0vAXNsWcd+B31+yXbz+SE/5vvRnfF9HYGzz0orEq0lySm3rr2OrY2dTvrttHdyX89hXnjBuNJ+MWNeWNmgO8amn4MOGMF+j7a4Bve60ufGwfjxnf/loafmzJvLJpe0f1L9/Zk0f1/oQHfHtrSfiDpV7WFgDwLa+l4S9sAr6jtSS8PVgAfEdr6Rm/FO7jAd+tWnrGq6IxJsCbWQt4prU0/OGK2NIf3wF892pJ+MMVeXA3zJbXGBPgzawl4d2Xc8SLOo0xAd7MWsx4prUkfAX7+C3Am1lLw6uiHhPgDa0FPNNaAv7gwu3y37kDvKG1mPFMa0n4Cl7OAd7QWgLe+y8a6rBePSbAG1qrMeOJqMcEeENrSXhl1GMCvKG1NPwQR/VdrSXhD86vjufs4RxmfPdqafgLm+4X4DtXS8If3lgVX85bqADfsVoS3hbmY8vK/olL9ZgAb2gtDa+KekyAN7S2Pvg0eaMeCl61BHzwnbtqXs4B3qhazHimtYBnWkvCV/BOGsAbWqsx44fVvJwDvFG1GvAVfecO8EbVasCPsanvYC0J7+3jsz8dQT0mwBtaqzHjiajHBHhDa2n4MY7qu1pLwh+cX8WM72gtDV/lz9wB3qhaEp56Ce/khTIPwqRcqnEDswhqxVIaHvv4rtaS8NjHd7eWhsc+vrO1JLxyH68eE+ANraVnPP53rrO19IxXRT0mwBtaC3imtQR8xR+MAHijajHjmdYCnmktDR/5vXOA71YtCR/5vXOA71gtDR/+3jnAd6yWhI/83jnAd6yWhldFPSbAG1oLeKa1gGdaC3imtYBnWkvBT+YV36oHfHtrCfjDFfd13LiajzQFvFG1BLz/g1d402QXazHjmdYS8OqfvAJ8e2speHXUYwK8obWAZ1pLwePlXIdrCXgc3HW5loCv+uVcirxRDwWv2hpnPOBNqiXgq345B3iTail4ddRjAryhtYBnWkvBV/BybgvwhtYS8FUc3AHe1FoCvoqXc4A3tRYznmktAV/FyznAm1pLwaujHBPgTa3Vht/uX7rnndxdA3zra3Xh9y/viS/3ZB/w7a/VhRez/OXbj+Spj978jgPfF8ncPvh5GI1ybaSxZP76sd11++iuhBf8+5jx7a8l4MXrufBj7oIZvytnui+vHBPgTa2l4KMfaRrZx9uY8R2oJeGjcY7qX76zB/hu1GrDp0Y5pi1a3qiHglct4JnWEvDKz64GfItrSfjbpT+2HPCm1hLw9qD8rxEHvKm1FHwFv6gA8KbWkvDKKMcEeFNrafjDFbGlz/45DMC3t5aEd79nO6zqJ3AAb1AtCe/u4yv7mTvAG1SLGc+0loTHPr67tTS8KsoxAd7UWsAzrQU801rAM62dLfwW4E2tpeHHJf+TBvDG1pLwB0vZv5UE8O2upeHL/u/clkLeqIeCVy0Jbw9K/hpxwBtbS8/4sr9bFvDG1tIzXhXVmABvbC3gmdbS8GX/kwbwxtaS8KX/WxbwxtaS8KV/EAPwxtZixjOtJeGxj+9uLQ2vimpMgDe2FvBMawn4gwu38Z27ztZixjOtJeHxcq67tQR88KlXeDnXwVqNGU9ENSbAG1sLeKa1JPzhjVWbjGpMgDe2lp7xqpdzLxR5kEjycuUNzCaoFUspeGVUT8bkjE9OeaPmAK/amcJPuQPemFoavuR/0gDe3FoSvux/y84A/tnVc+LvJ6+KJ+TH348tyxGjBBqqJeHLfueuevhnVy2J/PhEpNZbliNGCTRU264Zf9/6gV+VyDfPhbX+shwxSqChWhLeuH38P7/lbNaf/fHPWdYPvh9blidGCTRUS8OrohjTrPbxT8+efD76r09hH1+itpXwIqPRf3/+XGKZdowSaKiWhnc29XMGwo9Go//56hfiy/RjlEBDtSS8d3CXLa8Y06zgH3/P34gZ/8t/El2WJ0YJNFRLwpv3cs5FfvbVL4xG//l93x5FluWJUQIN1ZLw7mQ3b8aP/uPzlvX93x6Nbp4MluWJUQIN1dIzfknxifWKMc0A3slI5gP5V7HrGyXQUC0941VRjAnw5ta2HL6YvFECDdXS8KZ9587NCPDla0l4475X7wbwFdSS8Aa+nHvuu3vwheSNEmiodpYzftod8MbUkvAl9/GzgR/F4YvIGyXQUC0Nrwo9JsAbXEvCl3xDRT3wBeSNEmioloQv+YYKwBtcS8/4cu+Prwk+v7xRAg3VkvDK0GOaCfwI8JXUAj5nOMBP5i2L/sB6ekyAN7iWgD9c6dmT0+RxPT2mWcCPUuBzyxsl0FAtAS9fzCmO6+kx1QafV94ogYZqVfAr5LaeHhPgDa5tGfwoHT6nvFECDdVS8KofvAJ8i2sJeI3QYwK8wbUdgc8nb5RAQ7Xtgh8BvqpawOcM4AvBJ+QB31htV+BzyRsl0FCtNvx2/9I9+e/Re/3+5T3AF4hRtbrw+5f39h3v/SviSbAO+AIxqlYXfnfNfvn2I/+MhO+LZG4fnDxMCX0NVT4kUu6WuScbft0+uuvBy0nvhn4y1jrj80x5o6ZeQ7Xa8OGM3w7c64YfAb6yWl34YB9/9N56uJQeU73wOeSNEmioVhfePap/+c7etty3r+nAp7kD3pRabfjUkGMCvMm1HYLXlzdKoKHaNsGPAF9dLWv4p2ct62NvyVPh5yfJZSeI6wK+/fDyk1Gf35fy4QdgP7t6Qvw5mX1dwLcf/rE0f/or16MfgP30rDhxn5jygK8dflQ1vJMnr12PfgA2ZvyM4OPyzcNL6I2Njb//neAzEm9a5O89ALx58NryYa3nLuA/5y5w9vs3sanvOPyTV0867hJ+w1nyWP6mG7n5zwrgOwD/+Luvb2wA3nD4pHIKvK68Vyt9I/COvLupD37B1XQA3374++4bhT7nw2/ID8OW38Ah3AHfAfjn/nwPonFdwKvg091nC68p79cm3XXkAd9++Gl3wHOFV8sDvvXwae6A7z58qrtaHvAdhVfJA75m+CnjkvBZ7oBvJbyevE24q+gB3114Uh7wBeFj8obCU/KArxd+mjgdXkveVrhT9IBvM7zSPZse8C2GvwP47sHryGvBZ8gDvlb4FOCZw6fLA14Bn+VuAPyGJnyqPOBbC7+hDZ8mD/g64dOAs+CV8oB3lrKD38gBnyIP+JbCb+SCn5bPEPDfeBt/s234Jtw89zYtgK8Zfko+/d76b7yNv/UufBNurnubFp7wqb7F4DdmA++/8Tb2ZtvIm3Dz3NvUAL4c/EZu+KR8psDy8ldeux6b8ZE34ea5t6lhCZ/umwlPyReAT8in3ttlmd//hU+Iv1+Pvtm2s/AvsvMgK9GVqBsI80HOZN/Su27uvJsriuFddPOHv/jDFy/+wc/8xMWLf/cj/kX/+6e/mfveVp702hbM+Ix5XWDG+3M434yPz/nEvV3285Uf+6T4+8vf+9vi5I/777ns7IwnxtQgfKZ89fCB+5e/67PLIfxnl92LAW8EfACZFz5KH7m3y2Gktczv/ZSY969LfWcNwJeAz9LNDR8y5ocP6cN7G3Ff/i33jbc/LeQtS7q//klpzxA+070x+AhiEXhf3ru3y1rREdALP/hMXQI+TT5qWAjeo3fvrZ57wh7wijHFYiK8PnvMHvCKMUWTjZsPPiZYEH7Du7c53QN8wCvGFE0x+Gn5SuAl/Ysi7G4ArxhTJIRtLvg4X3H4jeWLxeGvJY/2cgTwheATeoXhFxdLwhemB3yD8IsyZeEL0gO+CHxSsBi84774xdLwheyZwVO2+vBThEXgF718cbEC+PzyHYCPys8MPiZfAfziYrXwufF5wZO02vDTjHnhFxej8IXlr00t0dcDvCZ8KJ8CmQ9+cXFm8PpPAFbwtGxN8IuLU/BF5bPh1fiA14X35dMwteGT6h58QXkanrbnBK+A1YNP9dSET2H34IvJK+EJesBrw7vyxeFT2X34QvIa8Jn0bYEn3GuFTzfVgM9gnz18Bj0jeJWrDnyGqhI+kz2ALyKvCZ9KD3h9+FHmZ1sp4An2EL6AvDZ8Cj0feCWrGv5WIXiSPQKfXz4H/JR8S+Ap96h8NrxSVQ1/61aWPAGvYK8NPmkPeG34W0Xgle4R+NzyOeFj8u2Ap91rgb91qwC8mj0Gn1c+L3zUngu82p2Ev+UnD7wOexw+J30B+MC+FfAKdw14Dfds+FvRaMPrsTcA79IDnoa/NRU9eF32JHwu+aLw0p4HvI57Kvy0e6p8El6ffQo+D30J+OWLxX9A1xz4UD59TFruKfBp7BrwedhT4PXly8EX/gHd2uCV7jOCT3dXwOdTT4XXli8LX9C+NfB67kn4DPZU+TsF0TPgdekrgC+CXxe82j2UTxuTpnsCPts9hf5OQfRMeD35iuDz2rcEXtc9Bk+yJ+QF028UZs+C17KvDj4Xvknwvvz0mLTdI/Aq9gDeN5oJvBq/WnhtfKPgt9LHpM8ewKvVncR8ZgZPPxOqh9fiNwvepY+PKQ+7C69D/kteGoGP6c8KXuFfEn67f+le/ES18FrYUdBv6nlH0xC8rz9j+Cz/cvD7l/fEV/REWfitrdHoQyVvdr6ZjquTX09/PswUfjH6fBM+qU+NKuCnci11W6ALv7tmv3z7UfREXyRz+4C0LNnw6/bR3UfREzJpMz5PlG+TJoLaUrXa8FMzHvCtrtWF19/Hlx+TXlBbqlYX3j2Yf/nOnvKovvyY9ILaUrXa8KmZzZj0gtpStYBnWgt4prWAZ1oLeKa1gGdaC3imtYBnWgt4prWAZ1oLeKa1gGdaWw6+bBr6SQ7UTgXwTGsBz7QW8Exra4ZHTAngmQbwTAN4pgE809QI7/x0fvRHduvI0Xv9/uW92mtFYX+9/ntrO2+D0KqtD36//0eP4j+kX0vrFfE4rDdRK57ntdfKR3lN70GuDf7on+QbsWJvy6kru+tN1IrC+ms/evM7a3oPco2begc++ka8miJmXwO122Lq1V4rtzKatXXD1z/1tq/YDW1o1mqv3ZXvaNarrRm+9r3e0XviGKuBQ4s1Cd/APl42m7WPd+FrP87dduZAI0f1Vxo5qt837qgeMSqAZxrAMw3gmQbwTMMVfjJviSwoVzu9WcdoGghbeCl6cH5VZ7VOhjX84UrPPliyXtm0Jz//pVc2xcljq/6CM39hWT33dCfDGn5yatUeLNjDObHl7zlPg/HxHX/BgjyDGd+1uPv4nrO1P7iwKYFd5PgCwHctvqjYmFtiA+84n9lJLAB89xLAX9j0z3ozPrYA8F1LIDoI9uVyHy/+DRcAvoMJRN1DeffVnX9U7y0Qfw5XcFSPdCqAZxrAMw3gmQbwTAN4pgE80wCeaQDPNIBnGsAzDeCZBvBMA3imATzTAJ5pAM80jOAfJhNe9GEy4UV3kgkvupZMffelfDjBP0gkvOjDDxIJL7rzbiLhRdcuJlLffSkfwMsAvssBfDSAlwF8lwP4aDoAf7gi3wb3xinvLc+TU5H3Pv9D5HQqvPvGmRR4eavHd9LhB/Jdd5nwQ+W77k1IB+AT1tEz42MK+LH7NugU+PGcAO6lwouLnOdLOvxY/XELJqQz8PLP0LLm5AnpLWblgpi1x76xIhfKpMAf/tXhn2fAywzT4W2bgJ+c+VfA1xUPXngfLPUmp75+XjwH5Occ9MQSsfz//tFZK3VTT8HLSZ8OP3BmdRq8eEaMAV9XPPih3CeLE592J7yY8t7Ud9//lhd+4GwoMg7u5I48DX6o9dE6BqRL8IL5cGVBnBgc33GfBO4+Xkx9uVY+ePneWZm0ffxCNrztXmx+ugQvp9vxHXFC8LsH5ZN5Zx/vPAlywg+8qZtxVC+3BoBvR/A6PhrAywC+ywF8NICXATzCJYBnGsAzDeCZBvBMA3imATzTAJ5pAM80gGcawDMN4JkG8EwDeKYBPNMAnmkAzzSAZxrAMw3gmQbwTAN4pvl/r9GreyUpv6IAAAAASUVORK5CYII=" alt="plot of chunk PlotProbabilities"/> </p>

<p>As expected, the spread of the selection probabilities increases as the number of tickets a person has in the hat increases (the variance of a binomial random variable increases with \( p \)). Also, the selection probabilities I estimated from simulation are <strong>slightly higher</strong> than the probabilities on the <a href="http://www.wser.org/2012/12/03/dec-8-lottery-details">WSER website</a> but <strong>within 1 SD</strong>.</p>

<p>Another way to think about the lottery is to plot the distribution of the frequency of runners selected by number of tickets. Annotate with the estimated expected value.</p>

<pre><code class="r">y1 &lt;- max(density(dfSummary$freq[dfSummary$tickets == 1])$y)
y2 &lt;- max(density(dfSummary$freq[dfSummary$tickets == 2])$y)
y3 &lt;- max(density(dfSummary$freq[dfSummary$tickets == 3])$y)
y4 &lt;- max(density(dfSummary$freq[dfSummary$tickets == 4])$y)
y &lt;- c(y1, y2, y3, y4)
ggplot(dfSummary, aes(x = freq, y = ..density.., fill = tickets)) + geom_density(alpha = 1/2, 
    color = NA) + scale_fill_brewer(type = &quot;div&quot;, palette = &quot;BrBG&quot;) + labs(title = &quot;2012 WSER Lottery Selection Frequency Densities&quot;, 
    x = &quot;Number&quot;, y = paste(&quot;Proportion of&quot;, size, &quot;simulations&quot;), fill = &quot;Tickets&quot;) + 
    annotate(&quot;text&quot;, label = format(simsum$Expected, digits = 3, trim = TRUE), 
        x = simsum$Expected, y = y) + theme(legend.position = &quot;bottom&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk PlotFrequencies"/> </p>

<p>Plot the results of all the simulated lotteries.</p>

<pre><code class="r">ggplot(dfSummary, aes(x = sim, y = freq, fill = tickets)) + geom_area(stat = &quot;identity&quot;) + 
    scale_fill_brewer(type = &quot;div&quot;, palette = &quot;BrBG&quot;) + scale_x_reverse() + 
    labs(title = paste(size, &quot;Simulated 2012 WSER Lotteries&quot;), x = &quot;Simulation&quot;, 
        y = &quot;Number of selected runners&quot;, fill = &quot;Tickets&quot;) + theme(legend.position = &quot;top&quot;) + 
    coord_flip()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk PlotLotteryResults"/> </p>

</body>

</html>

