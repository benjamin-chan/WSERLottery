<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>2013 Western States Endurance Run Lottery</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>2013 Western States Endurance Run Lottery</h1>

<p>Last update by Benjamin Chan (<a href="mailto:benjamin.ks.chan@gmail.com">benjamin.ks.chan@gmail.com</a>) on <code>2012-12-05 16:19:35</code> using <code>R version 2.15.2 (2012-10-26)</code>.</p>

<p>I was a little intrigued by how the Western States Endurance Run (WSER) calculated their lottery odds estimates. Their estimates can be found in the WSER 2012 <a href="http://www.wser.org/2012/12/03/dec-8-lottery-details">lottery details</a>.</p>

<p>On 12/5/2012, WSER updated their lottery details from the version they originally posted on 12/3/2012 (<a href="http://webcache.googleusercontent.com/search?q=cache:x6E-Gb-wm_wJ:www.wser.org/2012/12/03/dec-8-lottery-details/+&amp;cd=2&amp;hl=en&amp;ct=clnk&amp;gl=us">cached version</a>). The revised probabilities more closely match the results I was coming up with. The number of applicants and the number of tickets also have been revised from what was on the website on 12/3/2012.</p>

<blockquote>
<p>Updated 12/5</p>

<p>As posted on the <a href="http://www.wser.org/lottery2013.html">lottery applicant</a> page, we have 2295 total lottery applicants for the 2013 race.</p>

<p>122 applicants with four tickets = 488 tickets<br/>
207 applicants with three tickets = 621 tickets<br/>
480 applicants with two tickets = 960 tickets<br/>
1486 applicants with one ticket = 1486 tickets</p>

<p>Total tickets in the hat = 3555</p>

<p>Here is the list of tickets (<a href="http://www.wser.org/wp-content/uploads/2012/12/2013LotteryTickets.pdf">178 page pdf</a>)</p>

<p>We are going to draw 270 unique names in the lottery and then an additional five from the lottery within the lottery. That is, the folks in the audience who have not been selected up to that point. Based on 3555 total tickets and 270 names drawn, the odds of getting selected have been updated as follows:</p>

<p>one ticket odds = 7.9%<br/>
two ticket odds = 15.2%<br/>
three ticket odds = 21.9%<br/>
four ticket odds = 28.0%</p>

<p>We used a Monte Carlo simulation to calculate these updated odds.</p>
</blockquote>

<p>What are labeled as <em>odds</em> are really <em>probabilities</em>.</p>

<p>Here, I run a simulation of the lottery process to estimate probabilities of winning a slot for the Western States Endurance Run. The simulation does a few things</p>

<ul>
<li>Accounts for the changing probability distribution of the lottery hat as runners are selected</li>
<li>Once a runner is selected, their tickets are withdrawn from the hat</li>
<li>For each simulated lottery, the distribution of selected 1-ticket, 2-ticket, 3-ticket, and 4-ticket runners is determined</li>
<li>From this distributions of the simulated lotteries, the estimated selection probabilities are characterized</li>
<li>Selection probability distributions are plotted</li>
<li>Selection distributions from the simulated lotteries are also plotted</li>
</ul>

<p>Load the required packages.</p>

<pre><code class="r">require(xtable, quietly = TRUE)
require(ggplot2, quietly = TRUE)
</code></pre>

<h2>Setting up initial conditions</h2>

<p>Here is the code to set up the lottery hat data frame at the initial state. Print out some validation output just to make sure the initial state is set up correctly.</p>

<pre><code class="r">spots &lt;- 270
distn &lt;- c(1486, 480, 207, 122)
applicants &lt;- sum(distn)
runner &lt;- seq(1, applicants)
tickets &lt;- c(rep(4, distn[4]), rep(3, distn[3]), rep(2, distn[2]), rep(1, distn[1]))
dfHat0 &lt;- data.frame(runner, tickets)
dfHat0$prob &lt;- dfHat0$tickets/sum(dfHat0$tickets)
table(factor(dfHat0$tickets))
</code></pre>

<pre><code>## 
##    1    2    3    4 
## 1486  480  207  122
</code></pre>

<pre><code class="r">head(dfHat0)
</code></pre>

<pre><code>##   runner tickets     prob
## 1      1       4 0.001125
## 2      2       4 0.001125
## 3      3       4 0.001125
## 4      4       4 0.001125
## 5      5       4 0.001125
## 6      6       4 0.001125
</code></pre>

<pre><code class="r">tail(dfHat0)
</code></pre>

<pre><code>##      runner tickets      prob
## 2290   2290       1 0.0002813
## 2291   2291       1 0.0002813
## 2292   2292       1 0.0002813
## 2293   2293       1 0.0002813
## 2294   2294       1 0.0002813
## 2295   2295       1 0.0002813
</code></pre>

<h2>Lottery simulation</h2>

<p>The simulation needs to account for the changing relative distribution of tickets after a person is selected and their tickets are no longer in the pool of eligible tickets.</p>

<p>The matrix <code>lottery</code> is an \( I \times J \) matrix where row \( i \) is the \( i \)-th simulation and the column \( j \) is the \( j \)-th lottery winner drawn. The number of columns in the matrix is <code>270</code>, variable <code>spots</code>. The number of simulated lotteries is variable <code>size</code>. Set the random number seed as the date of the lottery in numeric form multipied by the number of applicants.</p>

<pre><code class="r">size &lt;- 1000
set.seed(as.numeric(as.Date(&quot;2012-12-08&quot;, format = &quot;%Y-%m-%d&quot;)) * applicants)
lottery &lt;- matrix(nrow = size, ncol = spots)
start &lt;- Sys.time()
for (i in 1:size) {
    dfHat &lt;- dfHat0
    for (j in 1:spots) {
        lottery[i, j] &lt;- sample(dfHat$runner, 1, prob = dfHat$prob)
        dfHat &lt;- subset(dfHat, runner != lottery[i, j])
        dfHat$prob &lt;- dfHat$tickets/sum(dfHat$tickets)
    }
}
end &lt;- Sys.time()
end - start
</code></pre>

<pre><code>## Time difference of 2.815 mins
</code></pre>

<p>Here&#39;s an example of the selected runners drawn from a random simulated lottery.</p>

<pre><code class="r">i &lt;- sample(seq(1, size), 1)
sampLottery &lt;- list(i, sort(lottery[i, ]))
names(sampLottery) &lt;- c(&quot;lottery&quot;, &quot;runner&quot;)
sampLottery
</code></pre>

<pre><code>## $lottery
## [1] 778
## 
## $runner
##   [1]    2    8   11   12   14   15   16   22   24   26   28   29   32   33
##  [15]   41   46   48   50   51   52   60   66   76   83   85   92   93   96
##  [29]   98  111  113  128  138  144  147  148  156  157  163  166  167  176
##  [43]  179  180  182  183  186  189  190  193  195  196  198  207  213  214
##  [57]  228  238  240  243  244  245  252  254  274  279  282  294  303  307
##  [71]  308  319  322  329  331  335  341  343  360  364  372  377  390  395
##  [85]  402  410  413  414  418  422  445  450  453  459  463  466  482  499
##  [99]  503  513  531  533  540  544  545  556  560  561  569  584  587  595
## [113]  599  600  605  607  609  610  611  613  624  625  627  635  643  652
## [127]  654  661  670  675  679  683  691  692  713  716  724  725  728  730
## [141]  733  734  735  747  752  754  756  760  768  783  791  793  801  802
## [155]  829  851  863  912  916  936  939  940  946  990  995 1019 1031 1045
## [169] 1055 1068 1105 1108 1135 1138 1209 1229 1234 1254 1291 1299 1303 1311
## [183] 1314 1315 1323 1334 1354 1355 1367 1377 1386 1403 1407 1413 1417 1422
## [197] 1425 1447 1496 1499 1503 1518 1520 1531 1539 1558 1564 1580 1590 1610
## [211] 1629 1640 1641 1692 1711 1731 1754 1761 1765 1799 1806 1809 1814 1821
## [225] 1826 1832 1842 1853 1860 1866 1872 1883 1885 1888 1905 1916 1924 1928
## [239] 1931 1933 1951 1952 1953 1957 1959 1987 2008 2016 2041 2042 2043 2055
## [253] 2063 2065 2074 2077 2110 2119 2134 2139 2152 2168 2187 2197 2207 2239
## [267] 2255 2258 2282 2283
</code></pre>

<h2>Format lottery simulation data</h2>

<p>I&#39;m not really interested in which runners were selected in the lottery simulation. What I&#39;m really after are estimates for the probability of selecting a runner, among the <code>270</code> available spots, with \( X \) tickets in the initial hat.</p>

<p>To get at this, first I&#39;ll have to match the runners selected to the number of tickets they started out with.</p>

<pre><code class="r">lottery2 &lt;- matrix(nrow = size, ncol = spots)
for (i in 1:size) {
    lottery2[i, ] &lt;- dfHat0$tickets[lottery[i, ]]
}
</code></pre>

<p>Reformat the <code>lottery2</code> matrix to an aggregated data frame for analysis.</p>

<pre><code class="r">tickets &lt;- factor(as.vector(t(lottery2)))
sim &lt;- rep(seq(1, size), each = spots)
dfLottery &lt;- data.frame(sim, tickets)
aggLottery &lt;- aggregate(tickets ~ sim, dfLottery, table)
sim &lt;- rep(seq(1, size), each = 4)
tickets &lt;- factor(rep(seq(1, 4), size))
freq &lt;- as.vector(t(aggLottery$tickets))
dfSummary &lt;- data.frame(sim, tickets, freq)
</code></pre>

<p>For each type of lottery applicant (1 ticket, 2 tickets, etc.), calculate the proportion of selected applicants. </p>

<pre><code class="r">total &lt;- rep(distn, size)
dfSummary$prob &lt;- 100 * (dfSummary$freq/total)
avg &lt;- aggregate(prob ~ tickets, dfSummary, mean)
med &lt;- aggregate(prob ~ tickets, dfSummary, median)
sd &lt;- aggregate(prob ~ tickets, dfSummary, sd)
ev &lt;- distn * avg[, 2]/100
probWSER &lt;- c(7.9, 15.2, 21.9, 28)
evWSER &lt;- distn * probWSER/100
diffprob &lt;- avg[, 2] - probWSER
diffev &lt;- ev - evWSER
pctdiff &lt;- 100 * diffprob/avg[, 2]
simsum &lt;- data.frame(avg, med[, 2], sd[, 2], distn, ev, probWSER, evWSER, diffprob, 
    diffev, pctdiff)
names(simsum) &lt;- c(&quot;Tickets&quot;, &quot;Mean&quot;, &quot;Median&quot;, &quot;SD&quot;, &quot;N&quot;, &quot;EV&quot;, &quot;Prob (WSER)&quot;, 
    &quot;EV (WSER)&quot;, &quot;Diff. prob.&quot;, &quot;Diff. EV&quot;, &quot;% diff.&quot;)
</code></pre>

<h2>Summarize lottery simulations</h2>

<p>Plot the distribution of probabilities from the <code>1,000</code> simulated lotteries. Annotate with the estimated mean selection probability.</p>

<pre><code class="r">y1 &lt;- max(density(dfSummary$prob[dfSummary$tickets == 1])$y)
y2 &lt;- max(density(dfSummary$prob[dfSummary$tickets == 2])$y)
y3 &lt;- max(density(dfSummary$prob[dfSummary$tickets == 3])$y)
y4 &lt;- max(density(dfSummary$prob[dfSummary$tickets == 4])$y)
y &lt;- c(y1, y2, y3, y4)
ggplot(dfSummary, aes(x = prob, y = ..density.., fill = tickets)) + geom_density(alpha = 1/2, 
    color = NA) + scale_fill_brewer(type = &quot;div&quot;, palette = &quot;BrBG&quot;) + labs(title = &quot;2012 WSER Lottery Selection Probability Densities&quot;, 
    x = &quot;Percent&quot;, y = paste(&quot;Proportion of&quot;, format(size, big.mark = &quot;,&quot;), 
        &quot;simulations&quot;), fill = &quot;Tickets&quot;) + annotate(&quot;text&quot;, label = paste(format(simsum$Mean, 
    digits = 2, trim = TRUE), &quot;%&quot;, sep = &quot;&quot;), x = simsum$Mean, y = y) + theme(legend.position = &quot;bottom&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk PlotProbabilities"/> </p>

<p>As expected, the spread of the selection probabilities increases as the number of tickets a person has in the hat increases (the variance of a binomial random variable increases with \( p \)).</p>

<p>Another way to think about the lottery is to plot the distribution of the frequency of runners selected by number of tickets. Annotate with the estimated expected value.</p>

<pre><code class="r">y1 &lt;- max(density(dfSummary$freq[dfSummary$tickets == 1])$y)
y2 &lt;- max(density(dfSummary$freq[dfSummary$tickets == 2])$y)
y3 &lt;- max(density(dfSummary$freq[dfSummary$tickets == 3])$y)
y4 &lt;- max(density(dfSummary$freq[dfSummary$tickets == 4])$y)
y &lt;- c(y1, y2, y3, y4)
ggplot(dfSummary, aes(x = freq, y = ..density.., fill = tickets)) + geom_density(alpha = 1/2, 
    color = NA) + scale_fill_brewer(type = &quot;div&quot;, palette = &quot;BrBG&quot;) + labs(title = &quot;2012 WSER Lottery Selection Distribution Densities&quot;, 
    x = &quot;Number&quot;, y = paste(&quot;Proportion of&quot;, format(size, big.mark = &quot;,&quot;), &quot;simulations&quot;), 
    fill = &quot;Tickets&quot;) + annotate(&quot;text&quot;, label = format(simsum$EV, digits = 2, 
    trim = TRUE), x = simsum$EV, y = y) + theme(legend.position = &quot;bottom&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk PlotFrequencies"/> </p>

<p>Print a table summarizing the simulated lotteries showing the mean and median selection probabilities and their standard deviations. Compare to probabilities given in the WSER 2012 <a href="http://www.wser.org/2012/12/03/dec-8-lottery-details">lottery details</a>.</p>

<pre><code class="r">print(xtable(simsum), type = &quot;html&quot;, include.rownames = FALSE)
</code></pre>

<!-- html table generated in R 2.15.2 by xtable 1.7-0 package -->

<!-- Wed Dec 05 16:22:27 2012 -->

<TABLE border=1>
<TR> <TH> Tickets </TH> <TH> Mean </TH> <TH> Median </TH> <TH> SD </TH> <TH> N </TH> <TH> EV </TH> <TH> Prob (WSER) </TH> <TH> EV (WSER) </TH> <TH> Diff. prob. </TH> <TH> Diff. EV </TH> <TH> % diff. </TH>  </TR>
  <TR> <TD> 1 </TD> <TD align="right"> 7.92 </TD> <TD align="right"> 7.94 </TD> <TD align="right"> 0.49 </TD> <TD align="right"> 1486.00 </TD> <TD align="right"> 117.67 </TD> <TD align="right"> 7.90 </TD> <TD align="right"> 117.39 </TD> <TD align="right"> 0.02 </TD> <TD align="right"> 0.28 </TD> <TD align="right"> 0.23 </TD> </TR>
  <TR> <TD> 2 </TD> <TD align="right"> 15.18 </TD> <TD align="right"> 15.21 </TD> <TD align="right"> 1.39 </TD> <TD align="right"> 480.00 </TD> <TD align="right"> 72.84 </TD> <TD align="right"> 15.20 </TD> <TD align="right"> 72.96 </TD> <TD align="right"> -0.02 </TD> <TD align="right"> -0.12 </TD> <TD align="right"> -0.16 </TD> </TR>
  <TR> <TD> 3 </TD> <TD align="right"> 21.86 </TD> <TD align="right"> 21.74 </TD> <TD align="right"> 2.58 </TD> <TD align="right"> 207.00 </TD> <TD align="right"> 45.25 </TD> <TD align="right"> 21.90 </TD> <TD align="right"> 45.33 </TD> <TD align="right"> -0.04 </TD> <TD align="right"> -0.08 </TD> <TD align="right"> -0.17 </TD> </TR>
  <TR> <TD> 4 </TD> <TD align="right"> 28.06 </TD> <TD align="right"> 27.87 </TD> <TD align="right"> 4.00 </TD> <TD align="right"> 122.00 </TD> <TD align="right"> 34.23 </TD> <TD align="right"> 28.00 </TD> <TD align="right"> 34.16 </TD> <TD align="right"> 0.06 </TD> <TD align="right"> 0.07 </TD> <TD align="right"> 0.22 </TD> </TR>
   </TABLE>

<p>My estimates and the probabilities calculated by WSER are essentially identical. Percent difference is never more than <code>0.2346</code>%.</p>

<p>Plot the outcomes of a random sample of the <code>1,000</code> simulated lotteries.</p>

<pre><code class="r">s &lt;- 100
i &lt;- sample(seq(1, size), s)
dfSample &lt;- dfLottery[dfLottery$sim %in% i, ]
dfSample$sim &lt;- factor(dfSample$sim)
levels(dfSample$sim) &lt;- rev(levels(dfSample$sim))
ggplot(dfSample, aes(x = sim, fill = tickets)) + geom_bar(width = 1) + scale_fill_brewer(type = &quot;div&quot;, 
    palette = &quot;BrBG&quot;) + labs(title = paste(&quot;Simulated 2012 WSER Lotteries\n&quot;, 
    &quot;Sample of&quot;, s, &quot;Lotteries&quot;), x = &quot;Simulated lottery&quot;, y = &quot;Number of selected runners&quot;, 
    fill = &quot;Tickets&quot;) + coord_flip() + theme(legend.position = &quot;top&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk PlotLotteryResults"/> </p>

</body>

</html>

