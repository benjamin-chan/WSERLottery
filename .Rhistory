simsum <- data.frame(avg, med[, 2], sd[, 2])
names(simsum) <- c("tickets", "mean", "median", "sd")
simsum
freq
aggLottery
head(dfSummary)
head(total)
source('~/.active-rstudio-document', echo=TRUE)
total <- rep(n, size)
dfSummary$prob <- 100 * (dfSummary$freq / total)
avg <- aggregate(prob ~ tickets, dfSummary, mean)
med <- aggregate(prob ~ tickets, dfSummary, median)
sd  <- aggregate(prob ~ tickets, dfSummary, sd)
ev <- n * avg[, 2] / 100
probMedinger <- c(7.6, 14.6, 21.1, 27.1)
evMedinger <- n * probMedinger / 100
diffprob <- avg[, 2] - probMedinger
diffev <- ev - evMedinger
simsum <- data.frame(avg, med[, 2], sd[, 2], n, ev, probMedinger, evMedinger, diffprob, diffev)
names(simsum) <- c("Tickets", "Mean", "Median", "SD", "N", "Expected", "Prob (Medinger)", "Expected (Medinger)", "Difference, prob.", "Difference, expected value")
print(xtable(simsum), type="html", include.rownames=FALSE)
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity", alpha=1/2) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
sum(evWSER)
total <- rep(n, size)
dfSummary$prob <- 100 * (dfSummary$freq / total)
avg <- aggregate(prob ~ tickets, dfSummary, mean)
med <- aggregate(prob ~ tickets, dfSummary, median)
sd  <- aggregate(prob ~ tickets, dfSummary, sd)
ev <- n * avg[, 2] / 100
probWSER <- c(7.6, 14.6, 21.1, 27.1)
evWSER <- n * probWSER / 100
diffprob <- avg[, 2] - probWSER
diffev <- ev - evWSER
simsum <- data.frame(avg, med[, 2], sd[, 2], n, ev, probWSER, evWSER, diffprob, diffev)
names(simsum) <- c("Tickets", "Mean", "Median", "SD", "N", "Expected", "Prob (WSER)", "Expected (WSER)", "Difference, prob.", "Difference, expected")
print(xtable(simsum), type="html", include.rownames=FALSE)
sum(evWSER)
sum(ev)
?format
source('~/.active-rstudio-document', echo=TRUE)
head(dfSummary)
s <- sample(seq(1, size), 100)
dfSample <- dfSummary[dfSummary$sim == s, ]
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s
s <- sample(seq(1, size), 100)
dfSample <- dfSummary[dfSummary$sim %in% s, ]
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- sample(seq(1, size), 100)
dfSample <- dfSummary[dfSummary$sim %in% s, ]
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_discrete() +
scale_x_reverse() +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- sample(seq(1, size), 100)
dfSample <- dfSummary[dfSummary$sim %in% s, ]
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- sample(seq(1, size), 100)
dfSample <- dfSummary[dfSummary$sim %in% s, ]
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip() +
theme_bw()
s <- sample(seq(1, size), 100)
dfSample <- dfSummary[dfSummary$sim %in% s, ]
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip() +
s <- sample(seq(1, size), 100)
dfSample <- dfSummary[dfSummary$sim %in% s, ]
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.10
i <- sample(seq(1, size), s * size)
dfSample <- dfSummary[dfSummary$sim %in% i, ]
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.20
i <- sample(seq(1, size), s * size)
dfSample <- dfSummary[dfSummary$sim %in% i, ]
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.20
i <- sample(seq(1, size), s * size)
dfSample <- dfSummary[dfSummary$sim %in% i, ]
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", color=NA) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.20
i <- sample(seq(1, size), s * size)
dfSample <- dfSummary[dfSummary$sim %in% i, ]
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", color=tickets) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.20
i <- sample(seq(1, size), s * size)
dfSample <- dfSummary[dfSummary$sim %in% i, ]
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets, color=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.20
i <- sample(seq(1, size), s * size)
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSummary$sim <- factor(dfSummary$sim)
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.20
i <- sample(seq(1, size), s * size)
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSummary$sim <- factor(dfSummary$sim)
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
#   scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.20
i <- sample(seq(1, size), s * size)
dfSample <- dfSummary[dfSummary$sim %in% i, ]
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
tickets <- factor(as.vector(t(lottery2)))
sim <- rep(seq(1, size), each=spots)
dfLottery <- data.frame(sim, tickets)
aggLottery <- aggregate(tickets ~ sim, dfLottery, table)
sim <- rep(seq(1, size), each=4)
tickets <- factor(rep(seq(1, 4), size))
freq <- as.vector(t(aggLottery$tickets))
dfSummary <- data.frame(sim, tickets, freq)
total <- rep(n, size)
dfSummary$prob <- 100 * (dfSummary$freq / total)
avg <- aggregate(prob ~ tickets, dfSummary, mean)
med <- aggregate(prob ~ tickets, dfSummary, median)
sd  <- aggregate(prob ~ tickets, dfSummary, sd)
ev <- n * avg[, 2] / 100
probWSER <- c(7.6, 14.6, 21.1, 27.1)
evWSER <- n * probWSER / 100
diffprob <- avg[, 2] - probWSER
diffev <- ev - evWSER
simsum <- data.frame(avg, med[, 2], sd[, 2], n, ev, probWSER, evWSER, diffprob, diffev)
names(simsum) <- c("Tickets", "Mean", "Median", "SD", "N", "Expected", "Prob (WSER)", "Expected (WSER)", "Difference, prob.", "Difference, expected")
print(xtable(simsum), type="html", include.rownames=FALSE)
s <- 0.20
i <- sample(seq(1, size), s * size)
dfSample <- dfSummary[dfSummary$sim %in% i, ]
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.20
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
rep(i2, 4)
rep(i2, each=4)
s <- 0.10
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, 4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
rstudio::viewData(dfSample)
s <- 0.10
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.10
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", color=NA) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.05
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", color=NA) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.05
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", color=NA, linetype=0) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.05
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", width=1) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.05
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", width=2) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.05
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", width=0) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.05
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", width=0, palette="BrBG") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.05
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.01
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.01
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", width=1) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.01
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", width=2) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.01
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfSummary[dfSummary$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity", width=0.5) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
head(dfLottery)
s <- 0.01
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfLottery[dfLottery$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(width=0.5) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.01
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfLottery[dfLottery$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
ggplot(dfSample, aes(x=sim, fill=tickets)) +
geom_bar(width=0.5) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.01
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfLottery[dfLottery$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
dfSample$sim <- factor(dfSample$sim)
ggplot(dfSample, aes(x=sim, fill=tickets)) +
geom_bar(width=0.5) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.01
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfLottery[dfLottery$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
dfSample$sim <- factor(dfSample$sim)
ggplot(dfSample, aes(x=sim, fill=tickets)) +
geom_bar(width=0.5) +
scale_fill_brewer(type="div", palette="BrBG") +
#   scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 0.01
i <- sample(seq(1, size), round(s * size))
i2 <- seq(1, round(s * size))
dfSample <- dfLottery[dfLottery$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
dfSample$sim <- factor(dfSample$sim)
ggplot(dfSample, aes(x=sim, fill=tickets)) +
geom_bar(width=1) +
scale_fill_brewer(type="div", palette="BrBG") +
#   scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 100
i <- sample(seq(1, size), s)
i2 <- seq(1, s)
dfSample <- dfLottery[dfLottery$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
dfSample$sim <- factor(dfSample$sim)
ggplot(dfSample, aes(x=sim, fill=tickets)) +
geom_bar(width=1) +
scale_fill_brewer(type="div", palette="BrBG") +
#   scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 100
i <- sample(seq(1, size), s)
i2 <- seq(1, s)
dfSample <- dfLottery[dfLottery$sim %in% i, ]
dfSample$sim <- rep(i2, each=4)
dfSample$sim <- factor(dfSample$sim)
ggplot(dfSample, aes(x=sim, fill=tickets)) +
geom_bar(width=1) +
scale_fill_brewer(type="div", palette="BrBG") +
#   scale_x_reverse() +
labs(title=paste("Simulated 2012 WSER Lotteries\n", s * 100, "% Sample", sep=""), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
theme_bw() +
coord_flip()
s <- 100
i <- sample(seq(1, size), s)
dfSample <- dfLottery[dfLottery$sim %in% i, ]
dfSample$sim <- factor(dfSample$sim)
ggplot(dfSample, aes(x=sim, fill=tickets)) +
geom_bar(width=1) +
scale_fill_brewer(type="div", palette="BrBG") +
labs(title=paste("Simulated 2012 WSER Lotteries\n", "Sample of", s, "Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
s <- 100
i <- sample(seq(1, size), s)
dfSample <- dfLottery[dfLottery$sim %in% i, ]
dfSample$sim <- factor(dfSample$sim)
ggplot(dfSample, aes(x=sim, fill=tickets)) +
geom_bar(width=1) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_discrete(size=2)
labs(title=paste("Simulated 2012 WSER Lotteries\n", "Sample of", s, "Lotteries"), x="Simulated lottery", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
