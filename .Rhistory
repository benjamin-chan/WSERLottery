start <- Sys.time()
end <- Sys.time()
end - start
?seed
??seed
seed <- as.date("2012-12-08", format="%Y-%m-%d")
seed <- as.Date("2012-12-08", format="%Y-%m-%d")
seed
mode(seed)
set.seed(as.Date("2012-12-08", format="%Y-%m-%d"))
applicants <- 2302
runner <- seq(1, applicants)
n <- c(1491, 482, 207, 122)
tickets <- c(rep(4, n[4]), rep(3, n[3]), rep(2, n[2]), rep(1, n[1]))
dfHat0 <- data.frame(runner, tickets)
dfHat0$prob <- dfHat0$tickets / sum(dfHat0$tickets)
table(factor(dfHat0$tickets))
head(dfHat0)
tail(dfHat0)
size <- 100
spots <- 270
set.seed(as.Date("2012-12-08", format="%Y-%m-%d") * applicants)
lottery <- matrix(nrow=size, ncol=spots)
start <- Sys.time()
for (i in 1:size) {
dfHat <- dfHat0
for (j in 1:spots){
lottery[i, j] <- sample(dfHat$runner, 1, prob=dfHat$prob)
dfHat <- subset(dfHat, runner != lottery[i, j])
dfHat$prob <- dfHat$tickets / sum(dfHat$tickets)
}
}
end <- Sys.time()
i <- sample(c(1, size), 1)
lottery[i, ]
sort(lottery[i,])
?count
length(lottery == 1)
sum(lottery == 1)
sum(lottery == 2)
sum(lottery == 3)
sum(lottery == 4)
sum(lottery == 5)
sum(lottery == 6)
paste(end - start)
as.numeric(as.Date("2012-12-08", format="%Y-%m-%d"))
applicants <- 2302
runner <- seq(1, applicants)
n <- c(1491, 482, 207, 122)
tickets <- c(rep(4, n[4]), rep(3, n[3]), rep(2, n[2]), rep(1, n[1]))
dfHat0 <- data.frame(runner, tickets)
dfHat0$prob <- dfHat0$tickets / sum(dfHat0$tickets)
table(factor(dfHat0$tickets))
head(dfHat0)
tail(dfHat0)
size <- 100
spots <- 270
set.seed(as.numeric(as.Date("2012-12-08", format="%Y-%m-%d")) * applicants)
lottery <- matrix(nrow=size, ncol=spots)
start <- Sys.time()
for (i in 1:size) {
dfHat <- dfHat0
for (j in 1:spots){
lottery[i, j] <- sample(dfHat$runner, 1, prob=dfHat$prob)
dfHat <- subset(dfHat, runner != lottery[i, j])
dfHat$prob <- dfHat$tickets / sum(dfHat$tickets)
}
}
end <- Sys.time()
end - start
i <- sample(c(1, size), 1)
sort(lottery[i, ])
lottery2 <- matrix(nrow=size, ncol=spots)
for (i in 1:size) {
lottery2[i, ] <- dfHat0$tickets[lottery[i, ]]
}
tickets <- factor(as.vector(t(lottery2)))
sim <- rep(seq(1, size), each=spots)
dfLottery <- data.frame(sim, tickets)
aggLottery <- aggregate(tickets ~ sim, dfLottery, table)
tickets <- factor(rep(seq(1, 4), size))
freq <- as.vector(t(aggLottery$tickets))
dfSummary <- data.frame(tickets, freq)
total <- rep(n, size)
dfSummary$prob <- 100 * (dfSummary$freq / total)
avg <- aggregate(prob ~ tickets, dfSummary, mean)
med <- aggregate(prob ~ tickets, dfSummary, median)
sd  <- aggregate(prob ~ tickets, dfSummary, sd)
simsum <- data.frame(avg, med[, 2], sd[, 2])
names(simsum) <- c("tickets", "mean", "median", "sd")
require(xtable)
print(xtable(simsum), type="html", include.rownames=FALSE)
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "Set2")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
#  geom_histogram(binwidth=2, alpha=1/4) +
geom_density(alpha=1/2, color=NA) +
#  facet_grid(~ tickets, "Ticket,s") +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "Set2")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", x=avg[, 2]) +
theme(legend.position="bottom")
format(avg[, 2], digits=1)
label=format(avg[, 2], digits=2)
format(avg[, 2], digits=2)
?format
format(avg[, 2], digits=2, trim=TRUE)
?density
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "Set2")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=0.5) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "Set2")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=Inf) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "Set2")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "Set2")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.95, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "Set2")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.92, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "Set2")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA, fill=pal) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=pal) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
scale_fill_discrete(color=pal) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
scale_fill_discrete(fill=pal) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
scale_fill_discrete(hue=pal) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=pal) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
pal
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(5), "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=pal) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(5, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=pal) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA, fill=pal) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
scale_fill_brewer(type="div") +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=2/3, color=NA) +
scale_fill_brewer(type="div") +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
scale_fill_brewer(type="div", pal="RdBu") +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
scale_fill_brewer(type="div", pal="BrBG") +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
scale_fill_brewer(type="div", pal=c("BrBG")) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
scale_fill_brewer(type="div", palette=c("RdBu")) +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
require(RColorBrewer, quietly=TRUE)
pal <- brewer.pal(4, "BrBG")
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
scale_fill_brewer(type="div", palette="RdBu") +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
scale_fill_brewer(type="div", palette="BrBG") +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.9, 0.3, 0.2, 0.1)) +
theme(legend.position="bottom")
source('~/.active-rstudio-document', echo=TRUE)
require(ggplot2, quietly=TRUE)
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
scale_fill_brewer(type="div", palette="BrBG") +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.91, 0.3, 0.2, 0.12)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
scale_fill_brewer(type="div", palette="BrBG") +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
scale_y_continuous(limits=c(0, 1)) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.91, 0.3, 0.2, 0.12)) +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
ggplot(dfSummary, aes(x=prob, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
scale_fill_brewer(type="div", palette="BrBG") +
labs(title="Selection probabilities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
scale_x_continuous(limits=c(0, max(dfSummary$prob))) +
annotate("text", label=format(avg[, 2], digits=2, trim=TRUE), x=avg[, 2], y=c(0.92, 0.3, 0.2, 0.12)) +
theme(legend.position="bottom")
head(simsum)
head(dfSummary)
head(dfLottery)
head(aggLottery)
head(sim)
dfSummary <- data.frame(sim=aggLottery$sim, tickets, freq)
head(dfSummary)
sim <- rep(seq(1, size), each=4)
tickets <- factor(rep(seq(1, 4), size))
freq <- as.vector(t(aggLottery$tickets))
dfSummary <- data.frame(sim, tickets, freq)
head(dfSummary)
require(ggplot2, quietly=TRUE)
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_bar() +
scale_fill_brewer(type="div", palette="BrBG") +
labs(title=paste(size, "simulated lotteries"), x="Lottery", y="Number of selected runners", fill="Tickets") +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_bar() +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_discrete() +
labs(title=paste(size, "simulated lotteries"), x="Lottery", y="Number of selected runners", fill="Tickets") +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_discrete() +
labs(title=paste(size, "simulated lotteries"), x="Lottery", y="Number of selected runners", fill="Tickets") +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_bar(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
#   scale_x_discrete() +
labs(title=paste(size, "simulated lotteries"), x="Lottery", y="Number of selected runners", fill="Tickets") +
theme(legend.position="bottom")
require(ggplot2, quietly=TRUE)
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
#   scale_x_discrete() +
labs(title=paste(size, "simulated lotteries"), x="Lottery", y="Number of selected runners", fill="Tickets") +
theme(legend.position="bottom")
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_y_continuous(limits=c(0, spots) +
labs(title=paste(size, "simulated lotteries"), x="Lottery", y="Number of selected runners", fill="Tickets") +
theme(legend.position="bottom")
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
labs(title=paste(size, "simulated lotteries"), x="Lottery", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
labs(title=paste(size, "simulated lotteries"), x="Lottery", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
labs(title=paste(size, "simulated lotteries"), x="Lottery", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top")
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
labs(title=paste(size, "simulated lotteries"), x="Lottery", y="Number of selected runners", fill="Tickets") +
theme(legend.position="bottom")
head(dfSummary)
rank(dfSummary$freq[dfSummary$tickets == 4])
order(dfSummary$freq[dfSummary$tickets == 4])
dfSummary$freq[dfSummary$tickets == 4])
dfSummary$freq[dfSummary$tickets == 4]
data.frame(order=order(dfSummary$freq[dfSummary$tickets == 4]), freq4=dfSummary$freq[dfSummary$tickets == 4])
?order
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_continuous(limits=c(size, 0))) +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_continuous(limits=c(size, 0)) +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_continuous(limits=c(0, size)) +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_continuous(limits=c(size, 1)) +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
ggplot(dfSummary, aes(x=sim, y=freq, fill=tickets)) +
geom_area(stat="identity") +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_reverse() +
labs(title=paste(size, "Simulated 2012 WSER Lotteries"), x="Simulation", y="Number of selected runners", fill="Tickets") +
theme(legend.position="top") +
coord_flip()
ggplot(dfSummary, aes(x=freq, y=..density.., fill=tickets)) +
geom_density(alpha=1/2, color=NA) +
scale_fill_brewer(type="div", palette="BrBG") +
scale_x_continuous(limits=c(0, max(dfSummary$freq))) +
labs(title="2012 WSER Lottery Probability Densities", x="%", y=paste("Proportion of", size, "simulations"), fill="Tickets") +
theme(legend.position="bottom")
avg <- aggregate(freq ~ tickets, dfSummary, mean)
med <- aggregate(freq ~ tickets, dfSummary, median)
sd  <- aggregate(freq ~ tickets, dfSummary, sd)
simsum <- data.frame(avg, med[, 2], sd[, 2])
names(simsum) <- c("tickets", "mean", "median", "sd")
simsum
freq
aggLottery
head(dfSummary)
head(total)
